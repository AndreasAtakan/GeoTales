{"mappings":"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","sources":["pres/js/helpers.js","pres/js/scenes.js","pres/js/textboxes.js","pres/js/map/map.js","pres/js/main.js"],"sourcesContent":["/*******************************************************************************\n* Copyright (C) Nordfjord EDB AS - All Rights Reserved                         *\n*                                                                              *\n* Unauthorized copying of this file, via any medium is strictly prohibited     *\n* Proprietary and confidential                                                 *\n* Written by Andreas Atakan <aca@geotales.io>, January 2022                  *\n*******************************************************************************/\n\n\"use strict\";\n\n\nexport function uuid(a) {\n\treturn a ? (a^Math.random()*16>>a/4).toString(16) : ([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g, uuid);\n}\n\n\n\nexport function import_data(data) {\n\t_OPTIONS = data.options;\n\n\tif(data.scenes.length <= 0) { return; }\n\n\tif(_SCENES.store.length <= 0) { document.dispatchEvent( new Event(\"_setup\") ); }\n\n\t_SCENES.importData(data.scenes);\n\t_TEXTBOXES.importData(data.textboxes);\n\t_MAP.importData(data.objects);\n\n\t_SCENES.current();\n}\n\n\n\nexport function get_basemap(url) {\n\tfor(let b of _BASEMAPS) {\n\t\tif(b.tiles._url == url) { return b; }\n\t}\n\treturn null;\n}\n\n\n\nexport function get_aspect_ratio_dimentions(w, h, r) {\n\tlet _w = r * h;\n\tif(_w <= w) {\n\t\treturn [_w, h];\n\t}else{\n\t\treturn [w, w / r];\n\t}\n}\n\n\n\n/*function is_internal_basemap(url) {\n\tif(url == \"https://api.mapbox.com/styles/v1/andreasatakan/ckwjt95pj0zn714lvg9q9p7da/tiles/256/{z}/{x}/{y}?access_token=pk.eyJ1IjoiYW5kcmVhc2F0YWthbiIsImEiOiJjazlndzM1cmUwMnl5M21tZjQ3dXpzeHJnIn0.oE5zp040ZzJj5QgCDznweg\") {\n\t\treturn `\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/bath.svg\" /> Bath house</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/bridge.svg\" /> Bridge</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/cemetery.svg\" /> Cemetery</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/circle.svg\" /> Settlement</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/circle_11.svg\" /> Settlement</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/circle_brown.svg\" /> Settlement</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/dam.svg\" /> Dam</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/diamond.svg\" /> Settlement</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/diamond_red.svg\" /> Settlement</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/lighthouse.svg\" /> Lighthouse</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/mine.svg\" /> Mine</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/mount.svg\" /> Mount</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/oasis.svg\" /> Oasis</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/pass.svg\" /> Pass</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/production.svg\" /> Production</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/rectangle.svg\" /> Settlement</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/settlement.svg\" /> Settlement</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/shipwreck.svg\" /> Shipwreck</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/spiral.svg\" /> Settlement</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/square.svg\" /> Settlement</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/star.svg\" /> Settlement</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/tumulus.svg\" /> Tumulus</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/villa.svg\" /> Villa</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/waterwheel.svg\" /> Waterwheel</p>\n\t\t\t<p style=\"margin-right: 1rem;\"><img style=\"width: 25px;\" src=\"https://raw.githubusercontent.com/klokantech/roman-empire/master/icons/windmill.svg\" /> Windmill</p>\n\t\t`;\n\t}\n\n\treturn null;\n}*/\n","/*******************************************************************************\n* Copyright (C) Nordfjord EDB AS - All Rights Reserved                         *\n*                                                                              *\n* Unauthorized copying of this file, via any medium is strictly prohibited     *\n* Proprietary and confidential                                                 *\n* Written by Andreas Atakan <aca@geotales.io>, January 2022                  *\n*******************************************************************************/\n\n\"use strict\";\n\nimport { uuid } from \"./helpers.js\";\n\n\nexport function Scenes() {\n\tthis.store = [];\n\tthis.active = \"\";\n\n\n\tthis.setup = function() {\n\t\t$(\"#sceneNav #prev\").click(ev => { _SCENES.prev(); });\n\t\t$(\"#sceneNav #next\").click(ev => { _SCENES.next(); });\n\n\t\tthis.bind();\n\t};\n\n\tthis.reset = function() {\n\t\t//\n\t};\n\n\tthis.get = function(id) {\n\t\tfor(let i = 0; i < this.store.length; i++) {\n\t\t\tlet s = Object.assign({}, this.store[i]);\n\t\t\tif(s.id == id) { s.index = i; return s; }\n\t\t}\n\t\treturn null;\n\t};\n\n\tthis.getPrevScene = function(id) {\n\t\tlet c = this.get(id);\n\t\tif(!c || c.index <= 0) { return; }\n\n\t\treturn Object.assign({}, this.store[c.index - 1]);\n\t};\n\n\tthis.getNextScene = function(id) {\n\t\tlet c = this.get(id);\n\t\tif(!c || c.index >= this.store.length-1) { return; }\n\n\t\treturn Object.assign({}, this.store[c.index + 1]);\n\t};\n\n\tthis.bind = function() {\n\t\t$(\"#bookmarks button#bookmark\").off(\"click\");\n\t\t$(\"#bookmarks button#bookmark\").click(ev => {\n\t\t\tthis.set( $(ev.target).data(\"id\") );\n\t\t});\n\n\t\t$(\"#textbox #content img\").off(\"click\");\n\t\t$(\"#textbox #content img\").click(ev => { ev.stopPropagation();\n\t\t\t$(\"#imageModal img#imgPreview\").attr(\"src\", ev.target.src);\n\t\t\t$(\"#imageModal\").modal(\"show\");\n\t\t});\n\t};\n\n\tthis.prev = function() {\n\t\tlet s = this.getPrevScene(this.active);\n\t\tif(!s) { return; }\n\t\tthis.set(s.id);\n\t\treturn s;\n\t};\n\n\tthis.current = function() {\n\t\tthis.set(this.active);\n\t};\n\n\tthis.next = function() {\n\t\tlet s = this.getNextScene(this.active);\n\t\tif(!s) { return; }\n\t\tthis.set(s.id);\n\t\treturn s;\n\t};\n\n\tthis.set = function(id) {\n\t\tlet s = this.get(id);\n\n\t\tthis.active = id;\n\n\t\t_TEXTBOXES.set(s.id);\n\t\t_MAP.set(s.id);\n\n\t\tsetTimeout(() => { this.bind(); }, 151);\n\t};\n\n\tthis.importData = function(data) {\n\t\tif(data.length <= 0) { return; }\n\n\t\tif(this.store.length <= 0 || !this.active) {\n\t\t\tthis.active = data[0].id;\n\t\t}\n\n\t\tfor(let i = 0; i < data.length; i++) {\n\t\t\tlet o = data[i];\n\t\t\tlet s = new Scene(o.id);\n\t\t\ts.bounds = o.bounds;\n\t\t\ts.wms = o.wms;\n\t\t\ts.basemap = o.basemap;\n\t\t\ts.bookmark = o.bookmark;\n\t\t\ts.title = o.title;\n\n\t\t\tif(s.bookmark) {\n\t\t\t\t$(\"#bookmarks ul\").append(`\n\t\t\t\t\t<li><button type=\"button\" class=\"dropdown-item\" id=\"bookmark\" data-id=\"${s.id}\">${s.title || `Scene ${i+1}`}</button></li>\n\t\t\t\t`);\n\t\t\t}\n\n\t\t\tthis.store.push(s);\n\t\t}\n\t};\n}\n\n\n\nfunction Scene(id) {\n\tthis.id = id || uuid();\n\n\tthis.bounds = null;\n\tthis.wms = null;\n\tthis.basemap = null;\n\n\tthis.bookmark = false;\n\tthis.title = \"\";\n}\n","/*******************************************************************************\n* Copyright (C) Nordfjord EDB AS - All Rights Reserved                         *\n*                                                                              *\n* Unauthorized copying of this file, via any medium is strictly prohibited     *\n* Proprietary and confidential                                                 *\n* Written by Andreas Atakan <aca@geotales.io>, January 2022                  *\n*******************************************************************************/\n\n\"use strict\";\n\nimport { uuid } from \"./helpers.js\";\n\n\nexport function Textboxes() {\n\tthis.store = [];\n\n\n\tthis.setup = function() {\n\t\t//\n\t};\n\n\tthis.reset = function() {\n\t\t//\n\t};\n\n\tthis.get = function(sceneId) {\n\t\tfor(let i = 0; i < this.store.length; i++) {\n\t\t\tlet t = Object.assign({}, this.store[i]);\n\t\t\tif(t.sceneId == sceneId) { t.index = i; return t; }\n\t\t}\n\t\treturn null;\n\t};\n\n\tthis.delete = function(sceneId) {\n\t\tlet t = this.get(sceneId);\n\t\tt.disable();\n\t\tthis.store.splice(t.index, 1);\n\t};\n\n\tthis.set = function(sceneId) {\n\t\tfor(let t of this.store) {\n\t\t\tif(t.sceneId == sceneId) {\n\t\t\t\tsetTimeout(() => { t.enable(); }, 150);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse{ t.disable(); }\n\t\t}\n\t};\n\n\tthis.importData = function(data) {\n\t\tif(data.length <= 0) { return; }\n\n\t\tfor(let o of data) {\n\t\t\tlet t = new Textbox(o.id);\n\t\t\tt.sceneId = o.sceneId;\n\t\t\tt.locked = o.locked;\n\t\t\tt.pos = o.pos; t.dim = o.dim;\n\t\t\tt.content = o.content;\n\n\t\t\tt.disable();\n\n\t\t\tthis.store.push(t);\n\t\t}\n\t};\n}\n\n\n\nfunction Textbox(id) {\n\tthis.id = id || uuid();\n\n\tthis.sceneId = \"\";\n\tthis.locked = false;\n\n\tthis.pos = \"left\";\n\tthis.dim = [0, 0.25];\n\tthis.content = \"\";\n\n\n\tthis.setOrientation = function() {\n\t\tswitch(this.pos) {\n\t\t\tcase \"left\":\n\t\t\t\t$(\"#textbox\").css({ left: \"10px\", right: \"auto\" });\n\t\t\t\tbreak;\n\n\t\t\tcase \"right\":\n\t\t\t\t$(\"#textbox\").css({ left: \"auto\", right: \"85px\" });\n\t\t\t\tbreak;\n\n\t\t\tdefault: break;\n\t\t}\n\t};\n\n\tthis.enable = function() {\n\t\tif(this.content == \"\") { return; }\n\n\t\tthis.setOrientation();\n\n\t\t$(\"#textbox #content\").html(this.content);\n\n\t\tif(this.dim) {\n\t\t\t$(\"#textbox\").css({ maxWidth: `${this.dim[1] * 100}%` });\n\t\t}\n\n\t\t$(\"#textbox\").css(\"opacity\", 0.85);\n\t};\n\n\tthis.disable = function() {\n\t\t$(\"#textbox\").css(\"opacity\", 0);\n\t};\n}\n","/*******************************************************************************\n* Copyright (C) Nordfjord EDB AS - All Rights Reserved                         *\n*                                                                              *\n* Unauthorized copying of this file, via any medium is strictly prohibited     *\n* Proprietary and confidential                                                 *\n* Written by Andreas Atakan <aca@geotales.io>, January 2022                  *\n*******************************************************************************/\n\n\"use strict\";\n\nimport { get_aspect_ratio_dimentions } from \"../helpers.js\";\nimport \"./layers.js\";\n\n\nL.Map.addInitHook(function() {\n\n\t// Init map aspect ratio\n\n\tthis.setAspectRatio();\n\n\n\n\t// Plugins\n\n\t/*this.addControl( new L.Control.Fullscreen({ position: \"topright\" }) );*/\n\n\t/*this.addControl( L.control.zoom({ position: \"bottomright\" }) );*/\n\n\t/*this.addControl( L.control.locate({ position: \"topright\" }) );*/\n\n\tthis.panLock = true;\n\tthis.isFullscreen = false;\n\n\n\n\n\n\t// Basemap\n\n\tthis.basemap = _BASEMAPS[10].tiles;\n\tthis.addLayer( this.basemap );\n\n\t// WMS\n\n\tthis.wms = {};\n\n\n\n\n\n\t// Object layers\n\n\tthis.objects = [];\n\tthis.objectLayer = L.featureGroup();\n\tthis.addLayer( this.objectLayer );\n\n\tthis.objectLayer.on(\"layeradd\", ev => {\n\t\tlet o = ev.layer;\n\n\t\tlet label = o.options.label;\n\t\tif(label) {\n\t\t\to.bindTooltip(label, { direction: \"center\", permanent: true });\n\t\t\tif(o instanceof L.ImageOverlay) { this.updateTooltip(o); }\n\t\t}\n\n\t\to.on(\"moveend\", ev => { this.updateTooltip(ev.target); });\n\n\t\tif(o instanceof L.ImageOverlay) { this.setIcon(o); }\n\t});\n\n\tthis.objectLayer.on(\"layerremove\", ev => {\n\t\tlet o = ev.layer;\n\n\t\to.closeTooltip(); o.unbindTooltip();\n\t\to.slideCancel();\n\t});\n\n\tthis.on(\"zoomend\", ev => {\n\t\tfor(let o of this.getLayers()) { this.updateTooltip(o); }\n\t});\n\tthis.on(\"zoom\", ev => { if(this._renderer) { this._renderer._reset(); } });\n\n\n\n\n\n\t// Map events\n\t//this.on(\"moveend\", ev => {});\n\n});\n\n\n\n\nL.Map.include({\n\n\tsetup: function() {\n\t\t$(\"div.leaflet-control-attribution a\").prop(\"target\", \"_blank\");\n\n\t\t$(\"#mapNav #zoomIn\").click(ev => { this.zoomIn(); });\n\t\t$(\"#mapNav #zoomOut\").click(ev => { this.zoomOut(); });\n\n\t\t$(\"#mapNav #panLock\").click(ev => {\n\t\t\tlet c = \"\";\n\t\t\tif(this.panLock) {\n\t\t\t\tc = \"ðŸ”“\"; this.enable();\n\t\t\t}else{\n\t\t\t\tc = \"ðŸ”’\"; this.disable();\n\t\t\t\tthis.fitBounds( _SCENES.get( _SCENES.active ).bounds, { maxZoom: this.getMaxZoom(), noMoveStart: true } );\n\t\t\t}\n\n\t\t\t$(ev.target).html(c);\n\t\t\tthis.panLock = !this.panLock;\n\t\t\t$(`#mapNav #zoomIn,\n\t\t\t   #mapNav #zoomOut`).prop(\"disabled\", this.panLock);\n\t\t});\n\n\t\tthis.disable();\n\t},\n\treset: function() {\n\t\tthis.clearLayers();\n\t},\n\n\tenable: function() {\n\t\tthis.dragging.enable();\n\t\tthis.scrollWheelZoom.enable();\n\t\tthis.touchZoom.enable();\n\t\tif(this.tapHold) { this.tapHold.enable(); }\n\n\t\tthis.doubleClickZoom.disable();\n\t},\n\tdisable: function() {\n\t\tthis.dragging.disable();\n\t\tthis.scrollWheelZoom.disable();\n\t\tthis.touchZoom.disable();\n\t\tif(this.tapHold) { this.tapHold.disable(); }\n\n\t\tthis.doubleClickZoom.disable();\n\t},\n\n\tsetAspectRatio: function() {\n\t\tlet w = $(\"#main\").outerWidth(),\n\t\t\th = $(\"#main\").outerHeight(),\n\t\t\tr = _OPTIONS.aspectratio;\n\t\tlet dim = get_aspect_ratio_dimentions(w, h, r);\n\n\t\tlet width = (dim[0]/w) * 100,\n\t\t\theight = (dim[1]/h) * 100,\n\t\t\tleft = (((w - dim[0]) / 2) / w) * 100,\n\t\t\ttop = (((h - dim[1]) / 2)/ h) * 100;\n\n\t\tif(this.isFullscreen) {\n\t\t\twidth = 100; height = 100;\n\t\t\tleft = 0; top = 0;\n\t\t}\n\n\t\t$(\"#map\").css({\n\t\t\twidth: `${width}%`,\n\t\t\theight: `${height}%`,\n\t\t\tleft: `${left}%`,\n\t\t\ttop: `${top}%`\n\t\t});\n\t\t$(\"#textbox\").css({ maxHeight: $(window).width() <= 560 ? `calc(100% - ${height}% - 60px)` : \"\" });\n\n\t\tthis.invalidateSize();\n\t\tif(_SCENES.active) { this.setFlyTo( _SCENES.get( _SCENES.active ).bounds ); }\n\t},\n\n\tsetFlyTo: function(bounds) {\n\t\tif(this.panLock) {\n\t\t\tthis.flyToBounds(bounds, { maxZoom: this.getMaxZoom(), noMoveStart: true, duration: _OPTIONS.panningspeed || null });\n\t\t}\n\t},\n\n\n\n\tclearLayers: function() {\n\t\tthis.objectLayer.clearLayers();\n\t},\n\n\tgetLayers: function() {\n\t\treturn this.objectLayer.getLayers();\n\t},\n\n\tsetObjects: function(sceneId) {\n\t\tlet os = this.getLayers().map(o => {\n\t\t\tlet r = this.extractObject(o); return { id: r.id, pos: r.pos, radius: r.radius, animationspeed: r.animationspeed };\n\t\t});\n\t\tthis.clearLayers();\n\t\tfor(let i = 0; i < this.objects.length; i++) {\n\t\t\tlet o = Object.assign({}, this.objects[i]);\n\t\t\tif(o.sceneId == sceneId) {\n\t\t\t\tlet pos = o.pos, rad = o.radius;\n\t\t\t\tfor(let oo of os) {\n\t\t\t\t\tif(o.id == oo.id) {\n\t\t\t\t\t\to.pos = oo.pos;\n\t\t\t\t\t\tif(o.type == \"circle\") { o.radius = oo.radius; }\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet object = this.createObject(o);\n\t\t\t\tthis.objectLayer.addLayer(object);\n\n\t\t\t\tfor(let oo of os) {\n\t\t\t\t\tif(o.id == oo.id) {\n\t\t\t\t\t\tobject.slideTo( pos , { radius: rad, duration: oo.animationspeed || _OPTIONS.animationspeed });\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tset: function(sceneId) {\n\t\tlet s = _SCENES.get(sceneId);\n\t\tthis.setBasemap(s.basemap);\n\t\tthis.setWMS(s.wms);\n\t\tthis.setObjects(sceneId);\n\t\tthis.setFlyTo(s.bounds);\n\t},\n\n\tsetIcon: function(o, size, icon) {\n\t\tif(!(o instanceof L.ImageOverlay)) { return; }\n\n\t\tif(size) {\n\t\t\tlet zoom = this.getZoom();\n\t\t\tlet c = this.project(o.getBounds().getCenter(), zoom);\n\t\t\to.setBounds([\n\t\t\t\tthis.unproject([ c.x - size[0] / 2, c.y - size[1] / 2 ], zoom),\n\t\t\t\tthis.unproject([ c.x + size[0] / 2, c.y + size[1] / 2 ], zoom)\n\t\t\t]);\n\t\t}\n\t\tif(icon) { o.setUrl(icon); }\n\n\t\t$(o._image).css(\"border-radius\", o.options.rounded ? \"50%\" : \"0\");\n\t\t//$(o._image).css(\"transform\", `rotate(${o.options.angle}deg)`);\n\t\t$(o._image).css(\"border\", `${o.options.borderThickness}px solid ${o.options.borderColor}`);\n\t\t$(o._image).css(\"filter\", `\n\t\t\tblur(${o.options.overlayBlur}px)\n\t\t\tgrayscale(${o.options.overlayGrayscale*100}%)\n\t\t\tdrop-shadow(0 0 ${o.options.overlayBrightness}px yellow)\n\t\t\topacity(${(1 - o.options.overlayTransparency)*100}%)\n\t\t`);\n\n\t\tif(o.options.label) { this.updateTooltip(o); }\n\t},\n\n\tupdateTooltip: function(o) {\n\t\tif(o.getTooltip()) {\n\t\t\to.closeTooltip();\n\t\t\tif(o instanceof L.ImageOverlay) {\n\t\t\t\tlet d = this.latLngToContainerPoint( o.getBounds().getNorthWest() ).distanceTo( this.latLngToContainerPoint( o.getBounds().getSouthWest() ) );\n\t\t\t\to.getTooltip().options.offset = [0, d / 2 - 10];\n\t\t\t}\n\t\t\to.openTooltip();\n\t\t}\n\t},\n\n\n\n\tgetWMS: function() {\n\t\treturn this.wms ? {\n\t\t\ttype: \"wms\",\n\t\t\turl: this.wms._url,\n\t\t\tlayers: this.wms.options.layers,\n\t\t\tformat: this.wms.options.format,\n\t\t\tversion: this.wms.options.version,\n\t\t\ttransparent: this.wms.options.transparent\n\t\t} : null;\n\t},\n\n\tsetWMS: function(source) {\n\t\tif(!source) {\n\t\t\tthis.wms = this.wms ? this.removeLayer( this.wms ) : null;\n\t\t\treturn;\n\t\t}\n\t\tif(this.wms\n\t\t&& (source.url || source._url) == this.wms._url\n\t\t&& (source.layers || source.options.layers) == this.wms.options.layers\n\t\t&& (source.format || source.options.format) == this.wms.options.format\n\t\t&& (source.version || source.options.version) == this.wms.options.version) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet layer;\n\n\t\tif(source instanceof L.TileLayer.WMS) {\n\t\t\tlayer = source;\n\t\t}else\n\t\tif(source.type == \"wms\") {\n\t\t\tlayer = L.tileLayer.wms(source.url, {\n\t\t\t\tlayers: source.layers,\n\t\t\t\tformat: source.format,\n\t\t\t\ttransparent: source.transparent,\n\t\t\t\tversion: source.version,\n\t\t\t\tminZoom: source.minZoom || 0,\n\t\t\t\tmaxZoom: source.maxZoom || 22,\n\t\t\t\tattribution: source.attribution || \"\"\n\t\t\t});\n\t\t}\n\t\telse{ return; }\n\n\t\tif(this.wms) { this.removeLayer( this.wms ); }\n\n\t\tthis.wms = layer;\n\n\t\tthis.addLayer( this.wms );\n\t\tthis.wms.bringToFront();\n\t},\n\n\tgetBasemap: function() {\n\t\tif(this.basemap instanceof L.TileLayer) {\n\t\t\treturn {\n\t\t\t\ttype: \"tiles\",\n\t\t\t\turl: this.basemap._url,\n\t\t\t\tminZoom: this.basemap.options.minZoom,\n\t\t\t\tmaxZoom: this.basemap.options.maxZoom,\n\t\t\t\tattribution: this.basemap.options.attribution\n\t\t\t};\n\t\t}else\n\t\tif(this.basemap instanceof L.ImageOverlay) {\n\t\t\treturn {\n\t\t\t\ttype: \"image\",\n\t\t\t\timg: this.basemap._url\n\t\t\t};\n\t\t}\n\t\treturn null;\n\t},\n\n\tsetBasemap: async function(source) {\n\t\tlet basemap;\n\n\t\tif(source instanceof L.TileLayer) {\n\t\t\tif(this.basemap instanceof L.TileLayer\n\t\t\t&& source._url == this.basemap._url) { return; }\n\n\t\t\tbasemap = source;\n\t\t}else\n\t\tif(source.type == \"tiles\") {\n\t\t\tif(this.basemap instanceof L.TileLayer\n\t\t\t&& source.url == this.basemap._url) { return; }\n\n\t\t\tbasemap = L.tileLayer(source.url, {\n\t\t\t\tminZoom: source.minZoom || 0,\n\t\t\t\tmaxZoom: source.maxZoom || 22,\n\t\t\t\tattribution: source.attribution || `&copy; <a href=\"https://${_HOST}\" target=\"_blank\">GeoTales</a>`\n\t\t\t});\n\t\t}else\n\t\tif(source.type == \"image\") {\n\t\t\tif(this.basemap instanceof L.ImageOverlay\n\t\t\t&& source.img == this.basemap._url) { return; }\n\n\t\t\tlet img = new Image();\n\t\t\timg.src = source.img;\n\t\t\tawait img.decode();\n\n\t\t\tlet r = img.width / img.height;\n\t\t\tlet b = _SCENES.get( _SCENES.active ).bounds;\n\t\t\tlet bounds = [b[0], []];\n\t\t\tlet tlp = this.latLngToContainerPoint(b[0]),\n\t\t\t\tbrp = this.latLngToContainerPoint(b[1]);\n\t\t\tlet h = brp.y - tlp.y,\n\t\t\t\tw = brp.x - tlp.x;\n\n\t\t\tif(r >= 1) { // width >= height\n\t\t\t\tlet p = this.containerPointToLatLng([brp.x, tlp.y + w / r]);\n\t\t\t\tbounds[1][0] = p.lat;\n\t\t\t\tbounds[1][1] = p.lng;\n\t\t\t}else{ // height > width\n\t\t\t\tlet p = this.containerPointToLatLng([tlp.x + r * h, brp.y]);\n\t\t\t\tbounds[1][0] = p.lat;\n\t\t\t\tbounds[1][1] = p.lng;\n\t\t\t}\n\n\t\t\tbasemap = L.imageOverlay(source.img, bounds, {\n\t\t\t\tzIndex: 0,\n\t\t\t\tminZoom: 0, maxZoom: 1000,\n\t\t\t\tattribution: `&copy; <a href=\"https://${_HOST}\" target=\"_blank\">GeoTales</a>`\n\t\t\t});\n\t\t}\n\t\telse{ return; }\n\n\t\tthis.removeLayer( this.basemap );\n\n\t\tthis.basemap = basemap;\n\n\t\tthis.presetZoom(this.basemap.options.minZoom, this.basemap.options.maxZoom);\n\n\t\tthis.addLayer( this.basemap );\n\t\tthis.basemap.bringToBack();\n\n\t\t$(\"div.leaflet-control-attribution a\").prop(\"target\", \"_blank\");\n\t},\n\n\tresetBasemap: function() { this.setBasemap( _BASEMAPS[10].tiles ); },\n\n\tpresetZoom: function(min, max) {\n\t\tlet zoom = this.getZoom();\n\t\tif(zoom < min || zoom > max) {\n\t\t\tif(zoom < min) { this.setZoom(min); }\n\t\t\tif(zoom > max) { this.setZoom(max); }\n\t\t}\n\t\tthis.setMinZoom(min);\n\t\tthis.setMaxZoom(max);\n\t},\n\n\n\n\tcreateObject: function(o) {\n\t\tlet oo = null;\n\n\t\tswitch(o.type) {\n\t\t\tcase \"avatar\":\n\t\t\t\too = L.imageOverlay(o.icon, o.pos, {\n\t\t\t\t\tinteractive:\t\t\tfalse,\n\t\t\t\t\tzIndex:\t\t\t\t\t200,\n\t\t\t\t\tlabel:\t\t\t\t\to.label,\n\t\t\t\t\tratio:\t\t\t\t\to.ratio,\n\t\t\t\t\trounded:\t\t\t\to.rounded,\n\t\t\t\t\tangle:\t\t\t\t\to.angle,\n\t\t\t\t\tborderColor:\t\t\to.borderColor,\n\t\t\t\t\tborderThickness:\t\to.borderThickness,\n\t\t\t\t\toverlayBlur:\t\t\to.blur,\n\t\t\t\t\toverlayBrightness:\t\to.brightness,\n\t\t\t\t\toverlayGrayscale:\t\to.grayscale,\n\t\t\t\t\toverlayTransparency:\to.transparency\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tcase \"polyline\":\n\t\t\t\too = L.polyline(o.pos, {\n\t\t\t\t\tinteractive:\tfalse,\n\t\t\t\t\tlabel:\t\t\to.label,\n\t\t\t\t\tdashArray:\t\to.dashed ? \"5, 10\" : \"\",\n\t\t\t\t\tcolor:\t\t\to.color,\n\t\t\t\t\tweight:\t\t\to.thickness,\n\t\t\t\t\topacity:\t\t1 - o.transparency\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tcase \"polygon\":\n\t\t\t\too = L.polygon(o.pos, {\n\t\t\t\t\tinteractive:\tfalse,\n\t\t\t\t\tlabel:\t\t\to.label,\n\t\t\t\t\tdashArray:\t\to.dashed ? \"5, 10\" : \"\",\n\t\t\t\t\tcolor:\t\t\to.lineColor,\n\t\t\t\t\tweight:\t\t\to.lineThickness,\n\t\t\t\t\topacity:\t\t1 - o.lineTransparency,\n\t\t\t\t\tfillColor:\t\to.fillColor,\n\t\t\t\t\tfillOpacity:\t1 - o.fillTransparency\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tcase \"rectangle\":\n\t\t\t\too = L.rectangle(o.pos, {\n\t\t\t\t\tinteractive:\tfalse,\n\t\t\t\t\tlabel:\t\t\to.label,\n\t\t\t\t\tdashArray:\t\to.dashed ? \"5, 10\" : \"\",\n\t\t\t\t\tcolor:\t\t\to.lineColor,\n\t\t\t\t\tweight:\t\t\to.lineThickness,\n\t\t\t\t\topacity:\t\t1 - o.lineTransparency,\n\t\t\t\t\tfillColor:\t\to.fillColor,\n\t\t\t\t\tfillOpacity:\t1 - o.fillTransparency\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tcase \"circle\":\n\t\t\t\too = L.circle(o.pos, {\n\t\t\t\t\tinteractive:\tfalse,\n\t\t\t\t\tradius:\t\t\to.radius,\n\t\t\t\t\tlabel:\t\t\to.label,\n\t\t\t\t\tdashArray:\t\to.dashed ? \"5, 10\" : \"\",\n\t\t\t\t\tcolor:\t\t\to.lineColor,\n\t\t\t\t\tweight:\t\t\to.lineThickness,\n\t\t\t\t\topacity:\t\t1 - o.lineTransparency,\n\t\t\t\t\tfillColor:\t\to.fillColor,\n\t\t\t\t\tfillOpacity:\t1 - o.fillTransparency\n\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tconsole.error(\"object type invalid\");\n\t\t\t\tbreak;\n\t\t}\n\n\t\too.options.id = o.id;\n\t\too.options.sceneId = o.sceneId;\n\n\t\treturn oo;\n\t},\n\n\textractObject: function(o) {\n\t\tlet oo = null;\n\n\t\tif(o instanceof L.ImageOverlay) {\n\t\t\tlet nw = o.getBounds().getNorthWest(), se = o.getBounds().getSouthEast();\n\t\t\too = {\n\t\t\t\tid:\t\t\t\t\to.options.id,\n\t\t\t\tsceneId:\t\t\to.options.sceneId,\n\t\t\t\ttype:\t\t\t\t\"avatar\",\n\t\t\t\tpos:\t\t\t\t[[nw.lat, nw.lng], [se.lat, se.lng]],\n\t\t\t\tlabel:\t\t\t\to.options.label,\n\t\t\t\ticon:\t\t\t\to._url,\n\t\t\t\tratio:\t\t\t\to.options.ratio,\n\t\t\t\trounded:\t\t\to.options.rounded,\n\t\t\t\tangle:\t\t\t\t0,\n\t\t\t\tborderColor:\t\to.options.borderColor,\n\t\t\t\tborderThickness:\to.options.borderThickness,\n\t\t\t\tblur:\t\t\t\to.options.overlayBlur,\n\t\t\t\tgrayscale:\t\t\to.options.overlayGrayscale,\n\t\t\t\tbrightness:\t\t\to.options.overlayBrightness,\n\t\t\t\ttransparency:\t\to.options.overlayTransparency,\n\t\t\t\tanimationspeed:\t\to.options.animationspeed\n\t\t\t};\n\t\t}else\n\t\tif(o instanceof L.Polygon) {\n\t\t\too = {\n\t\t\t\tid:\t\t\t\t\to.options.id,\n\t\t\t\tsceneId:\t\t\to.options.sceneId,\n\t\t\t\ttype:\t\t\t\to instanceof L.Rectangle ? \"rectangle\" : \"polygon\",\n\t\t\t\tpos:\t\t\t\to.getLatLngs(),\n\t\t\t\tlabel:\t\t\t\to.options.label,\n\t\t\t\tdashed:\t\t\t\t!!o.options.dashArray,\n\t\t\t\tlineColor:\t\t\to.options.color,\n\t\t\t\tlineThickness:\t\to.options.weight,\n\t\t\t\tlineTransparency:\t1 - o.options.opacity,\n\t\t\t\tfillColor:\t\t\to.options.fillColor,\n\t\t\t\tfillTransparency:\t1 - o.options.fillOpacity,\n\t\t\t\tanimationspeed:\t\to.options.animationspeed\n\t\t\t};\n\t\t}else\n\t\tif(o instanceof L.Polyline) {\n\t\t\too = {\n\t\t\t\tid:\t\t\t\to.options.id,\n\t\t\t\tsceneId:\t\to.options.sceneId,\n\t\t\t\ttype:\t\t\t\"polyline\",\n\t\t\t\tpos:\t\t\to.getLatLngs(),\n\t\t\t\tlabel:\t\t\to.options.label,\n\t\t\t\tdashed:\t\t\t!!o.options.dashArray,\n\t\t\t\tcolor:\t\t\to.options.color,\n\t\t\t\tthickness:\t\to.options.weight,\n\t\t\t\ttransparency:\t1 - o.options.opacity,\n\t\t\t\tanimationspeed:\to.options.animationspeed\n\t\t\t};\n\t\t}else\n\t\tif(o instanceof L.Circle) {\n\t\t\tlet p = o.getLatLng();\n\t\t\too = {\n\t\t\t\tid:\t\t\t\t\to.options.id,\n\t\t\t\tsceneId:\t\t\to.options.sceneId,\n\t\t\t\ttype:\t\t\t\t\"circle\",\n\t\t\t\tpos:\t\t\t\t[ p.lat, p.lng ],\n\t\t\t\tradius:\t\t\t\to.getRadius(),\n\t\t\t\tlabel:\t\t\t\to.options.label,\n\t\t\t\tdashed:\t\t\t\t!!o.options.dashArray,\n\t\t\t\tlineColor:\t\t\to.options.color,\n\t\t\t\tlineThickness:\t\to.options.weight,\n\t\t\t\tlineTransparency:\t1 - o.options.opacity,\n\t\t\t\tfillColor:\t\t\to.options.fillColor,\n\t\t\t\tfillTransparency:\t1 - o.options.fillOpacity,\n\t\t\t\tanimationspeed:\t\to.options.animationspeed\n\t\t\t};\n\t\t}else{ console.error(\"object type invalid\"); }\n\n\t\treturn oo;\n\t},\n\n\timportData: function(data) {\n\t\tfor(let i = 0; i < data.length; i++) {\n\t\t\tthis.objects.push( data[i] );\n\t\t}\n\t}\n\n});\n","/*******************************************************************************\n* Copyright (C) Nordfjord EDB AS - All Rights Reserved                         *\n*                                                                              *\n* Unauthorized copying of this file, via any medium is strictly prohibited     *\n* Proprietary and confidential                                                 *\n* Written by Andreas Atakan <aca@geotales.io>, January 2022                  *\n*******************************************************************************/\n\n\"use strict\";\n\nimport { import_data } from \"./helpers.js\";\nimport { init, reset } from \"./generate.js\";\n\nimport { Scenes } from \"./scenes.js\";\nimport { Textboxes } from \"./textboxes.js\";\n\nimport \"./map/map.js\";\n\n\nwindow.onload = function(ev) {\n\n\t// Disable mobile pinch-zoom\n\tdocument.addEventListener(\"touchmove\", function(ev) {\n\t\tif(ev.scale !== 1) { ev.preventDefault(); }\n\t}, false);\n\n\t// Set up window resize start/end events\n\tlet resizeTimer = false;\n\t$(window).on(\"resize\", function(ev) {\n\t\tif( !resizeTimer ) { $(window).trigger(\"resizestart\"); }\n\t\tclearTimeout(resizeTimer);\n\t\tresizeTimer = setTimeout(function() {\n\t\t\tresizeTimer = false;\n\t\t\t$(window).trigger(\"resizeend\");\n\t\t}, 250);\n\t}).on(\"resizeend\", function() { _MAP.setAspectRatio(); });\n\n\t// Set up nav-btn-fade-out\n\tlet btnTimer = null, btnFadeTime = 5000,\n\t\tbtnToggle = v => { $(\"#mapNav, #extraNav\").css(\"opacity\", v || 0); };\n\t$(window).on(\"mousemove\", function() {\n\t\tbtnToggle(1); clearTimeout(btnTimer);\n\t\tbtnTimer = setTimeout(btnToggle, btnFadeTime);\n\t});\n\tsetTimeout(btnToggle, btnFadeTime);\n\n\n\n\t_SCENES = new Scenes();\n\n\t$(\"#mapNav #fullscreen\").click(ev => {\n\t\tif(_MAP.isFullscreen) {\n\t\t\tif(document.exitFullscreen) { document.exitFullscreen(); }\n\t\t\telse if(document.webkitExitFullscreen) { document.webkitExitFullscreen(); } /* Safari */\n\t\t\telse if(document.msExitFullscreen) { document.msExitFullscreen(); } /* IE11 */\n\t\t}else{\n\t\t\tlet el = document.body;\n\t\t\tif(el.requestFullscreen) { el.requestFullscreen(); }\n\t\t\telse if(el.webkitRequestFullscreen) { el.webkitRequestFullscreen(); } /* Safari */\n\t\t\telse if(el.msRequestFullscreen) { el.msRequestFullscreen(); } /* IE11 */\n\t\t}\n\t\t_MAP.isFullscreen = !_MAP.isFullscreen;\n\t\t_MAP.setAspectRatio();\n\t});\n\t$(document).keydown(ev => { if([\"ArrowUp\", \"ArrowDown\", \"ArrowRight\", \"ArrowLeft\", \"Space\"].indexOf(ev.code) > -1) { ev.preventDefault(); } });\n\t$(document).keyup(ev => {\n\t\tlet keycode = ev.code;\n\n\t\tif([\"ArrowUp\",\"ArrowLeft\"].indexOf(keycode) > -1) { ev.preventDefault(); _SCENES.prev(); }\n\t\tif([\"ArrowDown\", \"ArrowRight\", \"Space\"].indexOf(keycode) > -1) { ev.preventDefault(); _SCENES.next(); }\n\t\tif([\"ArrowUp\", \"ArrowDown\", \"ArrowRight\", \"ArrowLeft\", \"Space\"].indexOf(keycode) > -1) { ev.preventDefault(); }\n\t});\n\n\t$(\"#shareModal input#linkInput\").val(`https://${_HOST}/pres.php?id=${_ID}`);\n\t$(\"#shareModal a#facebook\").prop(\"href\", `https://www.facebook.com/sharer/sharer.php?u=https://${_HOST}/pres.php?id=${_ID}`);\n\t$(\"#shareModal a#twitter\").prop(\"href\", `https://twitter.com/intent/tweet?url=https://${_HOST}/pres.php?id=${_ID}&text=`);\n\t$(\"#shareModal a#linkedin\").prop(\"href\", `https://www.linkedin.com/shareArticle?mini=true&url=https://${_HOST}/pres.php?id=${_ID}`);\n\t$(\"#shareModal a#pinterest\").prop(\"href\", `https://pinterest.com/pin/create/button/?url=https://${_HOST}/pres.php?id=${_ID}&media=&description=`);\n\t$(\"#shareModal a#email\").prop(\"href\", `mailto:?&subject=&cc=&bcc=&body=https://${_HOST}/pres.php?id=${_ID}%0A`);\n\t$(\"#shareModal button#copyLink\").click(ev => {  navigator.clipboard.writeText( $(\"#shareModal input#linkInput\").val() ); });\n\t$(\"#shareModal button#clone\").click(ev => {\n\t\t$(\"#loadingModal\").modal(\"show\");\n\n\t\t$.ajax({\n\t\t\ttype: \"POST\",\n\t\t\turl: \"api/map.php\",\n\t\t\tdata: {\n\t\t\t\t\"op\": \"clone\",\n\t\t\t\t\"id\": _ID,\n\t\t\t\t\"password\": _PASSWORD\n\t\t\t},\n\t\t\tdataType: \"json\",\n\t\t\tsuccess: function(result, status, xhr) {\n\t\t\t\twindow.location.assign(`edit.php?id=${result.id}`);\n\t\t\t},\n\t\t\terror: function(xhr, status, error) {\n\t\t\t\tconsole.log(xhr.status, error);\n\t\t\t\tif(xhr.status == 401) { window.location.assign(\"settings.php\"); }\n\t\t\t\telse{ setTimeout(function() { $(\"#loadingModal\").modal(\"hide\"); $(\"#shareModal\").modal(\"hide\"); $(\"#errorModal\").modal(\"show\"); }, 750); }\n\t\t\t}\n\t\t});\n\t});\n\n\t_TEXTBOXES = new Textboxes();\n\n\t_MAP = L.map(\"map\", {\n\t\tcenter: [ 50, 6 ],\n\t\tzoom: window.innerWidth < 575.98 ? 3 : 5,\n\t\tzoomControl: false,\n\t\tmaxZoom: 18,\n\t\tdoubleClickZoom: false,\n\t\tzoomAnimationThreshold: 100,\n\t\twheelPxPerZoomLevel: 1500,\n\t\tkeyboard: false,\n\t\ttap: false,\n\t\tboxZoom: false,\n\t\t//touchZoom: false,\n\t\t//worldCopyJump: true\n\n\t\tcontextmenu: true,\n\t\tcontextmenuItems: [\n\t\t\t{ text: \"Copy coordinates\", callback: ev => { navigator.clipboard.writeText( `${ev.latlng.lat}, ${ev.latlng.lng}` ); } },\n\t\t\t{ text: \"Center map here\", callback: ev => { _MAP.panTo(ev.latlng); } },\n\t\t\t\"-\",\n\t\t\t{ text: \"Zoom in\", icon: \"assets/zoom-in.png\", callback: ev => { _MAP.zoomIn(); } },\n\t\t\t{ text: \"Zoom out\", icon: \"assets/zoom-out.png\", callback: ev => { _MAP.zoomOut(); } }\n\t\t]\n\t});\n\n\tdocument.addEventListener(\"_setup\", ev => { init(); _MAP.setup(); _TEXTBOXES.setup(); _SCENES.setup(); });\n\tdocument.addEventListener(\"_reset\", ev => { _SCENES.reset(); _TEXTBOXES.reset(); _MAP.reset(); reset(); });\n\n\tsetTimeout(function() {\n\t\t$(\"button#closeAd\").css(\"display\", \"block\");\n\t}, 5000);\n\t$(\"button#closeAd\").click(ev => {\n\t\t$(\"#adsense\").css(\"display\", \"none\");\n\t});\n\n\n\n\t// Load data\n\t$(\"#loadingModal\").modal(\"show\");\n\t$.ajax({\n\t\ttype: \"GET\",\n\t\turl: \"api/map.php\",\n\t\tdata: {\n\t\t\t\"op\": \"read\",\n\t\t\t\"id\": _ID,\n\t\t\t\"password\": \"\"\n\t\t},\n\t\tdataType: \"json\",\n\t\tsuccess: function(result, status, xhr) {\n\t\t\tif(result.data) { import_data( JSON.parse(result.data) ); }\n\n\t\t\tsetTimeout(function() { $(\"#loadingModal\").modal(\"hide\"); }, 750);\n\t\t},\n\t\terror: function(xhr, status, error) {\n\t\t\tconsole.log(xhr.status, error);\n\n\t\t\tif(xhr.status == 401) { setTimeout(function() { $(\"#loadingModal\").modal(\"hide\"); $(\"#passwordModal\").modal(\"show\"); }, 750); }\n\t\t\telse{ setTimeout(function() { $(\"#loadingModal\").modal(\"hide\"); $(\"#errorModal\").modal(\"show\"); }, 750); }\n\t\t}\n\t});\n\n\t$(\"#passwordModal button#enter\").click(ev => {\n\t\tlet password = $(\"#passwordModal input#passwordInput\").val();\n\t\tpassword = password === \"\" ? password : sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash( password ));\n\t\t_PASSWORD = password;\n\n\t\t$(\"#passwordModal\").modal(\"hide\");\n\t\t$(\"#loadingModal\").modal(\"show\");\n\n\t\t$.ajax({\n\t\t\ttype: \"GET\",\n\t\t\turl: \"api/map.php\",\n\t\t\tdata: {\n\t\t\t\t\"op\": \"read\",\n\t\t\t\t\"id\": _ID,\n\t\t\t\t\"password\": password\n\t\t\t},\n\t\t\tdataType: \"json\",\n\t\t\tsuccess: function(result, status, xhr) {\n\t\t\t\tif(result.data) { import_data( JSON.parse(result.data) ); }\n\n\t\t\t\tsetTimeout(function() { $(\"#loadingModal\").modal(\"hide\"); }, 750);\n\t\t\t},\n\t\t\terror: function(xhr, status, error) {\n\t\t\t\tconsole.log(xhr.status, error);\n\t\t\t\tsetTimeout(function() { $(\"#loadingModal\").modal(\"hide\"); $(\"#errorModal\").modal(\"show\"); }, 750);\n\t\t\t}\n\t\t});\n\t});\n\n};\n"],"names":["$501bc82c97d13554$export$31b40729666a4ae0","a","Math","random","toString","replace","$501bc82c97d13554$export$3b2ba0326b56a54c","data","_OPTIONS","options","scenes","length","_SCENES","store","document","dispatchEvent","Event","importData","_TEXTBOXES","textboxes","_MAP","objects","current","$501bc82c97d13554$export$827cb160439a2d7c","w","h","r","_w","$12b18e89db4cbf5c$export$b4dfb75ee92ddb88","this","active","setup","$","click","ev","prev","next","bind","reset","get","id","i","s","Object","assign","index","getPrevScene","c","getNextScene","off","set","target","stopPropagation","attr","src","modal","setTimeout","o","$12b18e89db4cbf5c$var$Scene","bounds","wms","basemap","bookmark","title","append","push","$366a31f5762cebd2$export$1148a9c69cac2f12","sceneId","t","delete","disable","splice","enable","$366a31f5762cebd2$var$Textbox","locked","pos","dim","content","setOrientation","css","left","right","html","maxWidth","L","Map","addInitHook","setAspectRatio","panLock","isFullscreen","_BASEMAPS","tiles","addLayer","objectLayer","featureGroup","on","layer","label","bindTooltip","direction","permanent","ImageOverlay","updateTooltip","setIcon","closeTooltip","unbindTooltip","slideCancel","getLayers","_renderer","_reset","include","prop","zoomIn","zoomOut","fitBounds","maxZoom","getMaxZoom","noMoveStart","clearLayers","dragging","scrollWheelZoom","touchZoom","tapHold","doubleClickZoom","outerWidth","outerHeight","aspectratio","width","height","top","maxHeight","window","invalidateSize","setFlyTo","flyToBounds","duration","panningspeed","setObjects","os","map","extractObject","radius","animationspeed","rad","oo","type","object","createObject","oo1","slideTo","setBasemap","setWMS","size","icon","zoom","getZoom","project","getBounds","getCenter","setBounds","unproject","x","y","setUrl","_image","rounded","borderThickness","borderColor","overlayBlur","overlayGrayscale","overlayBrightness","overlayTransparency","getTooltip","d","latLngToContainerPoint","getNorthWest","distanceTo","getSouthWest","offset","openTooltip","getWMS","url","_url","layers","format","version","transparent","source","removeLayer","TileLayer","WMS","tileLayer","minZoom","attribution","bringToFront","getBasemap","img","async","_HOST","Image","decode","b","tlp","brp","p","containerPointToLatLng","lat","lng","p1","imageOverlay","zIndex","presetZoom","bringToBack","resetBasemap","min","max","setZoom","setMinZoom","setMaxZoom","interactive","ratio","angle","blur","brightness","grayscale","transparency","polyline","dashArray","dashed","color","weight","thickness","opacity","polygon","lineColor","lineThickness","lineTransparency","fillColor","fillOpacity","fillTransparency","rectangle","circle","console","error","nw","se","getSouthEast","Polygon","Rectangle","getLatLngs","Polyline","Circle","getLatLng","getRadius","onload","addEventListener","scale","preventDefault","resizeTimer","trigger","clearTimeout","btnTimer","btnToggle","v","exitFullscreen","webkitExitFullscreen","msExitFullscreen","el","body","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","keydown","indexOf","code","keyup","keycode","val","_ID","navigator","clipboard","writeText","ajax","op","password","_PASSWORD","dataType","success","result","status","xhr","location","log","center","innerWidth","zoomControl","zoomAnimationThreshold","wheelPxPerZoomLevel","keyboard","tap","boxZoom","contextmenu","contextmenuItems","text","callback","latlng","panTo","JSON","parse","sjcl","codec","hex","fromBits","hash","sha256"],"version":3,"file":"main.js.map"}